<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
<h1>Whiteboard</h1>
<canvas id="canvas1"
        style="background-color: yellow;"
        width="500" height="500" >

</canvas>
<button onclick = "clearCanvas()", type = "button">
    Clear Whiteboard
</button>

<script>

    // Constants and variables
    const element = document.getElementById('canvas1');
    const canvas = element.getContext('2d');
    let mouseID = -1;
    let lastDrawPos = [0, 0];
    let mousePos = [0, 0];
    let drawing = false;

    /* Drawing function to be repeated while mouse is down on canvas
    *  Function uses the current x and y position of mouse and draws from that point to the last position mouse was in
    */
    function whileMouseDown(canvasElem) {

        // Checks if this is the first draw since mouse has been clicked
        // If it is then lastDrawPos should be equal to current mouse position
        if (drawing == false) {
            lastDrawPos = [mousePos[0] + 1, mousePos[1] + 1]
        }
        canvas.moveTo(mousePos[0], mousePos[1]);
        canvas.lineTo(lastDrawPos[0], lastDrawPos[1]);
        canvas.stroke();
        lastDrawPos = mousePos;
        drawing = true;
        console.log(mousePos[0], mousePos[1]);
    }

    // When mouse is down, sets interval to repeatedly draw
    function mouseDown(canvasElem, event) {

        // Check to make sure interval is only set once
        if (mouseID == -1) {
            mouseID = setInterval(whileMouseDown.bind(null, canvasElem), 1);
        } 
    }

    // When mouse is up clear the interval and reset mouseID
    function mouseUp(event) {
        if (mouseID != -1) {
            clearInterval(mouseID);
            mouseID = -1;
            drawing = false;
        } 
    }

    /* Function repeatedly gets mouse coordinates any time the mouse moves
     * Returns the x and y coordinate in an array
     */

    function getMouseCoordinates (canvasElem, event) {
        let rect = canvasElem.getBoundingClientRect();
        let x = event.clientX - rect.left;
        let y = event.clientY - rect.top;
        console.log("Coordinate x: " + x, "Coordinate y: " + y);

        return [x, y];
    }

    
    function clearCanvas () {
        canvas.clearRect(0, 0, element.width, element.height);
        canvas.beginPath();
    }
    
    // Listeners to check if mouse is up, down, or moving
    element.addEventListener('mousedown', function(e) {
        mouseDown(element, e);
    });

    element.addEventListener('mouseup', function(e) {
        mouseUp(e);
    });

    element.addEventListener('mousemove', function(e) {
        mousePos = getMouseCoordinates(element, e);
    });

</script>

</body>
</html>